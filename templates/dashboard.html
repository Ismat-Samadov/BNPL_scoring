{% extends "base.html" %}

{% block title %}Analytics Dashboard - Agrarian BNPL{% endblock %}

{% block content %}
<div class="card">
    <h2>üìà Analytics Dashboard</h2>
    <p style="margin-bottom: 2rem; color: #555;">
        Comprehensive analytics based on 1,000 synthetic applicant profiles.
    </p>

    <div class="stats-grid">
        <div class="stat-card">
            <h4>Total Applicants</h4>
            <div class="stat-value">1,000</div>
            <p style="color: #7f8c8d; margin-top: 0.5rem;">Synthetic Profiles</p>
        </div>

        <div class="stat-card">
            <h4>Mean Late Payment Prob</h4>
            <div class="stat-value">13.2%</div>
            <p style="color: #7f8c8d; margin-top: 0.5rem;">Median: 11.8%</p>
        </div>

        <div class="stat-card">
            <h4>Approval Rate</h4>
            <div class="stat-value">99.9%</div>
            <p style="color: #7f8c8d; margin-top: 0.5rem;">PD < 50%</p>
        </div>

        <div class="stat-card">
            <h4>Auto-Approve Rate</h4>
            <div class="stat-value">67.2%</div>
            <p style="color: #7f8c8d; margin-top: 0.5rem;">PD < 15%</p>
        </div>
    </div>
</div>

<div class="card">
    <h2>üìä Risk Tier Distribution</h2>
    <table>
        <thead>
            <tr>
                <th>Risk Tier</th>
                <th>Count</th>
                <th>Percentage</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span class="badge badge-low">Low (PD < 15%)</span></td>
                <td><strong>672</strong></td>
                <td>67.2%</td>
                <td>Auto-approve</td>
            </tr>
            <tr>
                <td><span class="badge badge-medium">Medium (15-35%)</span></td>
                <td><strong>312</strong></td>
                <td>31.2%</td>
                <td>Reduced limits</td>
            </tr>
            <tr>
                <td><span class="badge badge-high">High (35-50%)</span></td>
                <td><strong>15</strong></td>
                <td>1.5%</td>
                <td>Manual review</td>
            </tr>
            <tr>
                <td><span class="badge badge-decline">Decline (‚â•50%)</span></td>
                <td><strong>1</strong></td>
                <td>0.1%</td>
                <td>Auto-decline</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h2>üè∑Ô∏è Product Recommendations</h2>
    <table>
        <thead>
            <tr>
                <th>Product</th>
                <th>Count</th>
                <th>Percentage</th>
                <th>Base Limit</th>
                <th>Tenor</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Fertilizer BNPL</strong></td>
                <td>332</td>
                <td>33.2%</td>
                <td>35,000</td>
                <td>3 months</td>
            </tr>
            <tr>
                <td><strong>Seeds BNPL</strong></td>
                <td>312</td>
                <td>31.2%</td>
                <td>20,000</td>
                <td>4 months</td>
            </tr>
            <tr>
                <td><strong>Input Bundle</strong></td>
                <td>185</td>
                <td>18.5%</td>
                <td>50,000</td>
                <td>6 months</td>
            </tr>
            <tr>
                <td><strong>Cash Advance</strong></td>
                <td>86</td>
                <td>8.6%</td>
                <td>10,000</td>
                <td>2 months</td>
            </tr>
            <tr>
                <td><strong>Premium BNPL</strong></td>
                <td>81</td>
                <td>8.1%</td>
                <td>75,000</td>
                <td>6 months</td>
            </tr>
            <tr>
                <td><strong>Equipment Lease</strong></td>
                <td>4</td>
                <td>0.4%</td>
                <td>150,000</td>
                <td>12 months</td>
            </tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h2>üåæ Risk by Farm Type</h2>
    <table>
        <thead>
            <tr>
                <th>Farm Type</th>
                <th>Avg Late Payment Prob</th>
                <th>Risk Level</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Smallholder</strong></td>
                <td>16.3%</td>
                <td><span class="badge badge-medium">Medium</span></td>
            </tr>
            <tr>
                <td><strong>Cooperative</strong></td>
                <td>10.8%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
            <tr>
                <td><strong>Commercial</strong></td>
                <td>8.3%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h2>üìç Risk by Region</h2>
    <table>
        <thead>
            <tr>
                <th>Region</th>
                <th>Avg Late Payment Prob</th>
                <th>Risk Level</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>West</strong></td>
                <td>15.2%</td>
                <td><span class="badge badge-medium">Medium</span></td>
            </tr>
            <tr>
                <td><strong>South</strong></td>
                <td>14.4%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
            <tr>
                <td><strong>North</strong></td>
                <td>12.8%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
            <tr>
                <td><strong>Central</strong></td>
                <td>12.4%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
            <tr>
                <td><strong>East</strong></td>
                <td>12.3%</td>
                <td><span class="badge badge-low">Low</span></td>
            </tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h2>üìä Chart Visualizations</h2>
    <p style="margin-bottom: 1.5rem; color: #555;">
        High-resolution charts are generated in the <code>charts/</code> directory. Download them for detailed analysis:
    </p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
        <div style="border: 2px solid #3498db; border-radius: 8px; padding: 1.5rem; text-align: center;">
            <h4 style="color: #3498db; margin-bottom: 1rem;">üìà Late Payment Distribution</h4>
            <p style="color: #555; font-size: 0.9rem; margin-bottom: 1rem;">
                Histogram showing risk tier distribution across applicants
            </p>
            <a href="/charts/01_late_payment_probability_distribution.png" target="_blank" class="btn btn-secondary">
                View Chart ‚Üí
            </a>
        </div>

        <div style="border: 2px solid #2ecc71; border-radius: 8px; padding: 1.5rem; text-align: center;">
            <h4 style="color: #2ecc71; margin-bottom: 1rem;">üåæ Farm Size vs Risk</h4>
            <p style="color: #555; font-size: 0.9rem; margin-bottom: 1rem;">
                Scatter plot correlating farm size with payment risk
            </p>
            <a href="/charts/02_farm_size_vs_payment_risk.png" target="_blank" class="btn btn-secondary">
                View Chart ‚Üí
            </a>
        </div>

        <div style="border: 2px solid #9b59b6; border-radius: 8px; padding: 1.5rem; text-align: center;">
            <h4 style="color: #9b59b6; margin-bottom: 1rem;">üè∑Ô∏è Product Distribution</h4>
            <p style="color: #555; font-size: 0.9rem; margin-bottom: 1rem;">
                Bar chart of recommended product frequencies
            </p>
            <a href="/charts/03_product_distribution.png" target="_blank" class="btn btn-secondary">
                View Chart ‚Üí
            </a>
        </div>
    </div>
</div>

<div style="text-align: center; margin-top: 2rem;">
    <a href="/" class="btn btn-primary">Back to Home</a>
</div>
{% endblock %}
